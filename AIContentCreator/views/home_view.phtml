<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1.0" />
    <title>Home - AI Content Creator</title>

    <link rel="stylesheet" href="<?= BASE_URL ?>styles/home.css">
</head>

<body>

    <!-- HEADER -->
    <header>AI CONTENT CREATOR</header>

    <div class="layout">

        <!-- ASIDE -->
        <aside>
            <div>
                <div class="user-avatar">
                    <?= strtoupper(substr($usuario['nombre'], 0, 1)) ?>
                </div>

                <div class="user-block-name">
                    <?= htmlspecialchars($usuario['nombre']) ?>
                    <?= htmlspecialchars($usuario['apellidos']) ?>
                </div>

                <div class="user-block-email">
                    <?= htmlspecialchars($usuario['email']) ?>
                </div>

                <div style="margin-top: 14px; font-size:13px; color:var(--muted); text-align:center;">
                    <p>DNI: <?= htmlspecialchars($usuario['dni']) ?></p>
                    <p>Empresa N¬∫: <?= htmlspecialchars($usuario['numero_empresa']) ?></p>
                </div>

                <nav class="aside-menu" style="margin-top:25px;">
                    <ul>
                        <li><a class="active" href="#"><span>üè†</span> Inicio</a></li>
                        <li><a href="index.php?controller=noticias"><span>üìù</span> Noticias</a></li>
                        <li><a href="#"><span>üéõÔ∏è</span> Preferencias</a></li>
                        <li><a href="#"><span>‚öôÔ∏è</span> Ajustes</a></li>
                        <li><a href="#"><span>‚ùì</span> Ayuda</a></li>
                        <li><a href="index.php?controller=auth&action=logout"><span>‚èª</span> Cerrar sesi√≥n</a></li>
                    </ul>
                </nav>
            </div>
        </aside>

        <!-- MAIN -->
        <main>
            <h1 class="page-title">G√©neros</h1>
            <p class="page-sub">Selecciona una categor√≠a para continuar</p>

            <?php if (!empty($generos)): ?>
                <?php foreach ($generos as $row): ?>
                    <article class="card">
                        <div class="card-header">
                            <h3><?= htmlspecialchars($row['tema']) ?></h3>

                            <form method="POST" action="<?= BASE_URL ?>controllers/eliminar_genero.php" class="delete-form">
<input type="hidden" name="id" value="<?= (int)$row['id_genero'] ?>">
                                <button type="submit" class="btn btn-delete"
                                        onclick="return confirm('¬øSeguro que deseas eliminar este g√©nero?');">
                                    Eliminar
                                </button>
                            </form>
                        </div>

                        <p><?= htmlspecialchars($row['descripcion']) ?></p>
                        <p>
                            <?= htmlspecialchars($row['frecuencia']) ?>
                            ‚Ä¢ <?= (int)$row['cantidad'] ?>
                            ‚Ä¢ <?= strtoupper(htmlspecialchars($row['idioma'])) ?>
                        </p>

<a href="index.php?controller=articulos&id_genero=<?= (int)$row['id_genero'] ?>">
    Ir a art√≠culos ‚Üí
</a>
                    </article>
                <?php endforeach; ?>
            <?php else: ?>
                <p>No hay g√©neros todav√≠a. Crea uno con el bot√≥n ‚Äú+‚Äù.</p>
            <?php endif; ?>

        </main>

    </div>

    <footer>
        ¬© 2025 AI Content Creator - Todos los derechos reservados
    </footer>

    <button id="fabAdd" class="fab" aria-label="A√±adir G√©nero" title="A√±adir G√©nero">+</button>

    <div id="modalBackdrop" class="modal-backdrop" aria-hidden="true">
        <div class="modal" role="dialog" aria-modal="true" aria-labelledby="modalTitle">
            <div class="modal-header">
                <h3 id="modalTitle" class="modal-title">Nuevo G√©nero</h3>
                <button class="btn ghost" id="btnClose">‚úï</button>
            </div>

            <form id="genreForm" method="POST" action="<?= BASE_URL ?>controllers/guardar_genero.php">
                <div class="modal-body">

                    <div>
                        <label for="tema">Tema</label>
                        <input type="text" id="tema" name="tema" required>
                    </div>

                    <div>
                        <label for="descripcion">Descripci√≥n</label>
                        <input type="text" id="descripcion" name="descripcion" required>
                    </div>

                    <div>
                        <label for="frecuencia">Frecuencia</label>
                        <select id="frecuencia" name="frecuencia" required>
                            <option value="" disabled selected>Selecciona‚Ä¶</option>
                            <option>Diario</option>
                            <option>Semanal</option>
                            <option>Mensual</option>
                        </select>
                    </div>

                    <div>
                        <label for="cantidad">Cantidad</label>
                        <input type="number" id="cantidad" name="cantidad" min="1" required>
                    </div>

                    <div>
                        <label for="idioma">Idioma</label>
                        <select id="idioma" name="idioma" required>
                            <option value="" disabled selected>Selecciona‚Ä¶</option>
                            <option value="es">Espa√±ol</option>
                            <option value="en">Ingl√©s</option>
                            <option value="fr">Franc√©s</option>
                        </select>
                    </div>

                    <div id="sourcesSection" class="sources-section">
                        <label>Fuentes</label>
                        <div id="sourcesList"></div>
                        <button type="button" class="btn add-source" id="btnAddSource">+ A√±adir fuente</button>
                    </div>

                    <input type="hidden" id="fuentes" name="fuentes">
                </div>

                <div class="modal-footer">
                    <button type="button" class="btn ghost" id="btnCancel">Cancelar</button>
                    <button type="submit" class="btn primary">Guardar</button>
                </div>
            </form>
        </div>
    </div>

    <script src="<?= BASE_URL ?>code/home.js"></script>
    <script src="<?= BASE_URL ?>code/generos.js"></script>

</body>
</html>
